<!DOCTYPE HTML>
<!--

    Copyright (C) 2011 Everit Kft. (http://www.everit.org)

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

            http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<html>

<head>
<meta charset="utf-8">
<title>Blobstore API</title>
<link rel="icon" type="image/ico" href="http://www.everit.org/fonts/favicon.ico">

<!--    <link rel="stylesheet" type="text/css" href="common/css/base.css">-->
<link href="http://www.everit.org/css/bootstrap.min.css" rel="stylesheet">
<link href="http://www.everit.org/css/docs.min.css" rel="stylesheet">
<link href="http://www.everit.org/css/everit.css" rel="stylesheet">
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push([ '_setAccount', 'UA-15041869-4' ]);
  _gaq.push([ '_setDomainName', 'everit.org' ]);
  _gaq.push([ '_trackPageview' ]);
</script>
</head>

<body class="bs-docs-home" data-spy="scroll" data-target="#affix-nav">
  <a class="sr-only" href="#content">Skip to main content</a>
  <header class="navbar navbar-static-top bs-docs-nav" id="top" role="banner">
    <div class="container">
      <div class="navbar-header">
        <button class="navbar-toggle" type="button" data-toggle="collapse"
          data-target=".bs-navbar-collapse">
          <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span
            class="icon-bar"></span> <span class="icon-bar"></span>
        </button>
        <a href="#" class="navbar-brand">Index</a>
      </div>
      <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
        <ul class="nav navbar-nav">
          <li><a href="https://github.com/everit-org/blobstore-api" target="_blank">Source</a></li>
          <li><a href="http://www.everit.org/" target="_blank">Community</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li><a href="http://www.everit.biz" target="_blank">Enterprise</a></li>
          <li><a href="http://everitorg.wordpress.com/" target="_blank">Blog</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="bs-docs-masthead everit-header" id="content" role="main">
    <div class="container">
      <span class="bs-docs-booticon bs-docs-booticon-lg bs-docs-booticon-outline"> <img
        class="logo" src="http://www.everit.org/fonts/sbz_e.svg" alt="E">
      </span>
      <p class="lead">Blobstore API</p>
    </div>
  </div>
  <div class="container">
    <div class="col-md-10">

      <div class="bs-docs-featurette cookbook">
        <h2 id="introduction" class="bs-docs-featurette-title">Introduction</h2>
        <p>Blobstore API allows the user to write and read large binary data in a transactional
          store. During the read and write operations, it is possible to call seek() just as if the
          accessed data was a file.</p>
      </div>
      <hr class="featurette-divider">

      <div class="bs-docs-featurette cookbook">
        <h2 id="usage" class="bs-docs-featurette-title">Usage</h2>
        <h3 id="blob_creation">Blob creation</h3>
        <pre class="prettyprint">try(BlobAccessor blobAccessor = blobstore.createBlob()) {
  // Write the data
  blobAccessor.write(myDataByteArray, 0, myDataByteArray.length);
}</pre>
        <h3 id="updating_a_blob">Updating a blob</h3>
        <pre class="prettyprint">try(BlobAccessor blobAccessor = blobstore.updateBlob(blobId)) {
  // Seek to some place where we want to update
  blobAccessor.seek(10);
  // And do some update
  blobAccessor.write(myByteArray, 0, myByteArray.length);
}</pre>
        <h3 id="reading_from_a_blob">Reading from a blob</h3>
        <pre class="prettyprint">try(BlobReader blobReader = blobstore.readBlob(blobId)) {
  // Seek to a place where you want to read from
  blobReader.seek(15);
  blobAccessor.read(myByteArray, 0, myByteArray.length);
}</pre>
        <h3 id="other_notes">Other notes</h3>
        <p>
          <i>Blob</i> operations must always be in JTA transaction. The best is to use the <a
            href="https://github.com/everit-org/transaction-propagator-jta">transaction-propagator-jta</a>
          project for this purpose.
        </p>
        <p>
          <i>BlobAccessor</i> inherits from <i>BlobReader</i> so reading is possible during updating
          or creating the <i>Blob</i>.
        </p>
        <p>
          It is recommended not to open a Blob for longer time. In case a file is uploaded from the
          Internet, it is recommended to use the Servlet Async API and always write as much only as
          there is in the buffer, than close the <i>BlobAccessor</i>. Next time data is available
          again on the HTTP channel, open a <i>BlobAccessor</i> again and seek to the end of the <i>Blob</i>
          before writing the data out from the buffer.
        </p>
      </div>
      <hr class="featurette-divider">

      <div class="bs-docs-featurette cookbook">
        <h2 id="implementations" class="bs-docs-featurette-title">Implementations</h2>
        <p>The following implementations are available for the API:</p>
        <ul>
          <li><a href="https://github.com/everit-org/blobstore-mem">blobstore-mem</a>: Stores
            blobs in the memory. This project is intended to use for unit tests.</li>
          <li><a href="https://github.com/everit-org/blobstore-jdbc">blobstore-jdbc</a>: The
            implementations stores large objects within relational databases by using the JDBC Blob
            interface.</li>
          <li><a href="https://github.com/everit-org/blobstore-cache">blobstore-cache</a>: A
            cache wrapper for any blobstore that stores frequently read blob chunks in memory.</li>
        </ul>
      </div>
      <hr class="featurette-divider">

      <div class="bs-docs-featurette cookbook">
        <h2 id="testing" class="bs-docs-featurette-title">Testing</h2>
        <p>
          All <i>Blobstore</i> implementations should be tested with the <a
            href="https://github.com/everit-org/blobstore-testbase">blobstore-testbase</a> project.
        </p>
      </div>
      <hr class="featurette-divider">
    </div>

    <!--        Affix-->
    <div class="col-md-2 col-sm-0 col-xs-0">
      <nav id="affix-nav">
        <ul class="nav nav-pills nav-stacked everit-affix" data-spy="affix" data-offset-top="350"
          data-offset-bottom="140">
          <li class="active"><a href="#introduction">Introduction</a></li>
          <li><a href="#usage">Usage</a>
            <ul class="nav nav-pills nav-stacked">
              <li><a href="#blob_creation">Blob creation</a>
              <li><a href="#updating_a_blob">Updating a blob</a>
              <li><a href="#reading_from_a_blob">Reading from a blob</a>
              <li><a href="#other_notes">Other notes</a>
            </ul></li>
          <li><a href="#implementations">Implementations</a></li>
          <li><a href="#testing">Testing</a></li>
        </ul>
      </nav>
    </div>
  </div>

  <div></div>
  <footer class="bs-docs-footer" role="contentinfo">
    <div class="container">
      <div class="bs-docs-social">
        <ul class="bs-docs-social-buttons">
          <li class="follow-btn "><a href="https://twitter.com/EveritOrg"
            class="twitter-follow-button" data-show-count="true">Follow @EveritOrg</a></li>
          <li class="tweet-btn"><a href="https://twitter.com/share"
            class="twitter-share-button" data-url="http://www.everit.org/">Tweet</a></li>
        </ul>
      </div>
    </div>
  </footer>

  <!-- Bootstrap core JavaScript
================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="http://www.everit.org/js/jquery-2.1.1.min.js"></script>
  <script src="http://www.everit.org/js/bootstrap.min.js"></script>
  <script src="http://www.everit.org/js/everit.js "></script>
  <script type="text/javascript">
      (function() {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl'
            : 'http://www')
            + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <script src="http://www.everit.org/js/prettify/run_prettify.js"></script>
</body>

</html>
